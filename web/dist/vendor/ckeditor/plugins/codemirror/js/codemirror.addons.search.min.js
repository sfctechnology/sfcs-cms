!function(){function e(e,o,n){var t;return(t=e.getWrapperElement().appendChild(document.createElement("div"))).className=n?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top","string"==typeof o?t.innerHTML=o:t.appendChild(o),t}function o(e,o){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=o}CodeMirror.defineExtension("openDialog",(function(n,t,r){function i(){f||(f=!0,s.parentNode.removeChild(s))}var c;o(this,null);var s=e(this,n,r&&r.bottom),f=!1,u=this;return(c=s.getElementsByTagName("input")[0])?(CodeMirror.on(c,"keydown",(function(e){r&&r.onKeyDown&&r.onKeyDown(e,c.value,i)||(13==e.keyCode||27==e.keyCode)&&(CodeMirror.e_stop(e),i(),u.focus(),13==e.keyCode&&t(c.value))})),r&&r.onKeyUp&&CodeMirror.on(c,"keyup",(function(e){r.onKeyUp(e,c.value,i)})),r&&r.value&&(c.value=r.value),c.focus(),CodeMirror.on(c,"blur",i)):(n=s.getElementsByTagName("button")[0])&&(CodeMirror.on(n,"click",(function(){i(),u.focus()})),n.focus(),CodeMirror.on(n,"blur",i)),i})),CodeMirror.defineExtension("openConfirm",(function(n,t,r){function i(){f||(f=!0,s.parentNode.removeChild(s),u.focus())}var c;o(this,null);var s=e(this,n,r&&r.bottom),f=(r=s.getElementsByTagName("button"),!1),u=this,l=1;for(r[0].focus(),n=0;n<r.length;++n)c=r[n],function(e){CodeMirror.on(c,"click",(function(o){CodeMirror.e_preventDefault(o),i(),e&&e(u)}))}(t[n]),CodeMirror.on(c,"blur",(function(){--l,setTimeout((function(){0>=l&&i()}),200)})),CodeMirror.on(c,"focus",(function(){++l}))})),CodeMirror.defineExtension("openNotification",(function(n,t){function r(){f||(f=!0,clearTimeout(i),c.parentNode.removeChild(c))}o(this,r);var i,c=e(this,n,t&&t.bottom),s=t&&(void 0===t.duration?5e3:t.duration),f=!1;CodeMirror.on(c,"click",(function(e){CodeMirror.e_preventDefault(e),r()})),s&&(i=setTimeout(r,t.duration))}))}(),function(){function e(){this.overlay=this.posFrom=this.posTo=this.query=null}function o(o){return o.state.search||(o.state.search=new e)}function n(e,o,n){return e.getSearchCursor(o,n,"string"==typeof o&&o==o.toLowerCase())}function t(e,o,n,t){e.openDialog?e.openDialog(o,t):t(prompt(n,""))}function r(e){var o=e.match(/^\/(.*)\/([a-z]*)$/);return o?RegExp(o[1],-1==o[2].indexOf("i")?"":"i"):e}function i(e,n){var i=o(e);if(i.query)return c(e,n);t(e,u,"Search for:",(function(o){e.operation((function(){var t;o&&!i.query&&(i.query=r(o),e.removeOverlay(i.overlay),i.overlay="string"==typeof(t=i.query)?{token:function(e){if(e.match(t))return"searching";e.next(),e.skipTo(t.charAt(0))||e.skipToEnd()}}:{token:function(e){if(e.match(t))return"searching";for(;!e.eol()&&(e.next(),!e.match(t,!1)););}},e.addOverlay(i.overlay),i.posFrom=i.posTo=e.getCursor(),c(e,n))}))}))}function c(e,t){e.operation((function(){var r=o(e),i=n(e,r.query,t?r.posFrom:r.posTo);(i.find(t)||(i=n(e,r.query,t?CodeMirror.Pos(e.lastLine()):CodeMirror.Pos(e.firstLine(),0))).find(t))&&(e.setSelection(i.from(),i.to()),e.scrollIntoView({from:i.from(),to:i.to()}),r.posFrom=i.from(),r.posTo=i.to())}))}function s(e){e.operation((function(){var n=o(e);n.query&&(n.query=null,e.removeOverlay(n.overlay))}))}function f(e,o){t(e,l,"Replace:",(function(i){i&&(i=r(i),t(e,a,"Replace with:",(function(t){if(o)e.operation((function(){for(var o,r=n(e,i);r.findNext();)"string"!=typeof i?(o=e.getRange(r.from(),r.to()).match(i),r.replace(t.replace(/\$(\d)/,(function(e,n){return o[n]})))):r.replace(t)}));else{s(e);var r=n(e,i,e.getCursor()),c=function(){var o,t=r.from();((o=r.findNext())||(r=n(e,i),(o=r.findNext())&&(!t||r.from().line!=t.line||r.from().ch!=t.ch)))&&(e.setSelection(r.from(),r.to()),e.scrollIntoView({from:r.from(),to:r.to()}),function(e,o,n,t){e.openConfirm?e.openConfirm(o,t):confirm("Replace?")&&t[0]()}(e,h,0,[function(){f(o)},c]))},f=function(e){r.replace("string"==typeof i?t:t.replace(/\$(\d)/,(function(o,n){return e[n]}))),c()};c()}})))}))}var u='Search: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',l='Replace: <input type="text" style="width: 10em"/> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',a='With: <input type="text" style="width: 10em"/>',h="Replace? <button>Yes</button> <button>No</button> <button>Stop</button>";CodeMirror.commands.find=function(e){s(e),i(e)},CodeMirror.commands.findNext=i,CodeMirror.commands.findPrev=function(e){i(e,!0)},CodeMirror.commands.clearSearch=s,CodeMirror.commands.replace=f,CodeMirror.commands.replaceAll=function(e){f(e,!0)}}(),function(){function e(e,n,t,r){if(this.atOccurrence=!1,this.doc=e,null==r&&"string"==typeof n&&(r=!1),t=t?e.clipPos(t):o(0,0),this.pos={from:t,to:t},"string"!=typeof n)n.global||(n=RegExp(n.source,n.ignoreCase?"ig":"g")),this.matches=function(t,r){var i,c,s,f,u;if(t){for(n.lastIndex=0,i=e.getLine(r.line).slice(0,r.ch),c=0;n.lastIndex=c,(u=n.exec(i))&&(f=(s=u).index,(c=s.index+(s[0].length||1))!=i.length););(c=s&&s[0].length||0)||(0==f&&0==i.length?s=void 0:f!=e.getLine(r.line).length&&c++)}else n.lastIndex=r.ch,i=e.getLine(r.line),c=(s=n.exec(i))&&s[0].length||0,(f=s&&s.index)+c==i.length||c||(c=1);if(s&&c)return{from:o(r.line,f),to:o(r.line,f+c),match:s}};else{r&&(n=n.toLowerCase());var i=r?function(e){return e.toLowerCase()}:function(e){return e},c=n.split("\n");this.matches=1==c.length?n.length?function(t,r){var c,s=i(e.getLine(r.line)),f=n.length;if(t?r.ch>=f&&-1!=(c=s.lastIndexOf(n,r.ch-f)):-1!=(c=s.indexOf(n,r.ch)))return{from:o(r.line,c),to:o(r.line,c+f)}}:function(){}:function(n,t){var r,s,f,u=t.line,l=n?c.length-1:0,a=c[l],h=i(e.getLine(u)),d=n?h.indexOf(a)+a.length:h.lastIndexOf(a);if(!(n?d>t.ch||d!=a.length:d<t.ch||d!=h.length-a.length))for(;!(n?!u:u==e.lineCount()-1);){if(h=i(e.getLine(u+=n?-1:1)),a=c[n?--l:++l],!(0<l&&l<c.length-1))return r=n?h.lastIndexOf(a):h.indexOf(a)+a.length,(n?r!=h.length-a.length:r!=a.length)?void 0:(s=o(t.line,d),f=o(u,r),{from:n?f:s,to:n?s:f});if(h!=a)break}}}}var o=CodeMirror.Pos;e.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function n(e){return e=o(e,0),r.pos={from:e,to:e},r.atOccurrence=!1,!1}for(var t,r=this,i=this.doc.clipPos(e?this.pos.from:this.pos.to);;){if(this.pos=this.matches(e,i))return this.pos.from&&this.pos.to||console.log(this.matches,this.pos),this.atOccurrence=!0,this.pos.match||!0;if(e){if(!i.line)return n(0);i=o(i.line-1,this.doc.getLine(i.line-1).length)}else{if(t=this.doc.lineCount(),i.line==t-1)return n(t);i=o(i.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(e){this.atOccurrence&&(e=CodeMirror.splitLines(e),this.doc.replaceRange(e,this.pos.from,this.pos.to),this.pos.to=o(this.pos.from.line+e.length-1,e[e.length-1].length+(1==e.length?this.pos.from.ch:0)))}},CodeMirror.defineExtension("getSearchCursor",(function(o,n,t){return new e(this.doc,o,n,t)})),CodeMirror.defineDocExtension("getSearchCursor",(function(o,n,t){return new e(this,o,n,t)}))}();